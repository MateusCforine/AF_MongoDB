<h1>Gestor Financeiro Pessoal</h1>

<section class="form">
  <h2>Nova movimentação</h2>

  <form (ngSubmit)="criar()">
    <div>
      <label>Tipo</label>
      <select [(ngModel)]="tipo" name="tipo">
        <option value="receita">Receita</option>
        <option value="despesa">Despesa</option>
      </select>
    </div>

    <div>
      <label>Categoria</label>
      <input [(ngModel)]="categoria" name="categoria" required />
    </div>

    <div>
      <label>Descrição</label>
      <input [(ngModel)]="descricao" name="descricao" required />
    </div>

    <div>
      <label>Valor</label>
      <input
        type="number"
        step="0.01"
        [(ngModel)]="valor"
        name="valor"
        required
      />
    </div>

    <div>
      <label>Data</label>
      <input type="date" [(ngModel)]="data" name="data" required />
    </div>

    <button type="submit" [disabled]="salvando">Salvar</button>
  </form>
</section>

<section class="lista">
  <h2>Movimentações</h2>

  <p *ngIf="carregando">Carregando...</p>
  <p *ngIf="erro">{{ erro }}</p>

  <p *ngIf="!carregando && movimentacoes.length === 0">
    Nenhuma movimentação cadastrada.
  </p>

  <table *ngIf="movimentacoes.length > 0">
    <thead>
      <tr>
        <th>Data</th>
        <th>Tipo</th>
        <th>Categoria</th>
        <th>Descrição</th>
        <th>Valor</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="let m of movimentacoes"
        [class.receita]="m.tipo === 'receita'"
        [class.despesa]="m.tipo === 'despesa'"
      >
        <td>{{ m.data | date: 'dd/MM/yyyy' }}</td>
        <td>{{ m.tipo }}</td>
        <td>{{ m.categoria }}</td>
        <td>{{ m.descricao }}</td>
        <td>{{ m.valor | currency: 'BRL' : 'symbol' }}</td>
        <td>
          <button type="button" (click)="excluir(m)">Excluir</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="saldo" *ngIf="movimentacoes.length > 0">
    Saldo:
    <span [class.positivo]="saldo >= 0" [class.negativo]="saldo < 0">
      {{ saldo | currency: 'BRL' : 'symbol' }}
    </span>
  </div>
</section>
